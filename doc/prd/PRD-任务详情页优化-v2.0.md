# 产品需求文档 (PRD)

## 1. 概述

- **功能名称**：任务详情页优化 v2.0
- **核心价值**：提供现代化、高效的任务详情编辑体验，完全重新实现任务详情面板
- **目标用户**：项目管理员、任务负责人、团队成员
- **核心问题**：原有任务详情面板实现不满足用户体验要求，需完全重构

## 2. 功能需求

### 2.1 功能清单

| 功能名称 | 功能描述 | 用户价值 | 优先级 |
|:--------:|:--------:|:--------:|:------:|
| 双栏布局 | 左侧编辑区 + 右侧属性区 | 清晰分离内容与属性 | P0 |
| 富文本描述 | 集成成熟富文本编辑器 | 支持丰富的内容格式 | P0 |
| 子任务管理 | 查看列表、点击详情、点击创建 | 高效管理子任务 | P0 |
| 属性编辑 | 状态/负责人/优先级/排期/工时 | 快速修改任务属性 | P0 |
| 自定义字段 | 根据配置动态渲染字段 | 灵活扩展任务属性 | P0 |
| 字段图标配置 | 字段管理支持配置图标 | 提升视觉辨识度 | P1 |

### 2.2 用户故事

#### P0 核心功能

**F-101 双栏布局**
- 作为用户，我希望任务详情采用双栏布局，以便同时查看和编辑任务内容与属性
- 业务规则：左侧约60%宽度，右侧约40%宽度

**F-102 富文本描述编辑**
- 作为用户，我希望使用富文本编辑器编写任务描述，以便使用丰富的格式
- 业务规则：
  - 集成成熟的富文本编辑器组件
  - 支持基础格式：粗体、斜体、标题、列表、引用、代码块
  - 支持 Markdown 语法

**F-103 子任务管理**
- 作为用户，我希望在任务详情中管理子任务，以便快速了解和操作子任务
- 业务规则：
  - 显示子任务列表（只读展示，无勾选框）
  - 点击子任务项 → 打开该子任务的详情页
  - 点击「添加子任务」 → 弹出任务创建页

**F-104 属性编辑**
- 作为用户，我希望在右侧快速编辑任务属性，以便高效更新任务信息
- 业务规则：
  - 状态：带彩色圆点的下拉选择器
  - 优先级：High=红色标签，Medium=黄色，Low=蓝色
  - 日期：日期选择器，默认显示「未开始」/「未完成」
  - 工时：数值输入，单位「人天」

**F-105 自定义字段显示**
- 作为用户，我希望在任务详情中看到自定义字段，以便查看和编辑扩展属性
- 业务规则：
  - 根据字段配置动态渲染
  - 支持显示字段图标（依赖字段配置功能扩展）

#### P1 重要功能

**F-106 字段图标配置**
- 作为管理员，我希望为自定义字段配置图标，以便提升字段辨识度
- 业务规则：
  - 在字段管理模块中增加图标选择功能
  - 任务详情面板根据配置显示对应图标

## 3. 页面需求

| 页面名称 | 页面类型 | 核心功能 | 入口 | 优先级 |
|:--------:|:--------:|:--------:|:----:|:------:|
| 任务详情面板 | 侧边滑出面板 | 查看和编辑任务完整信息 | 点击任务条/任务行 | P0 |
| 任务创建页 | 模态框 | 创建新任务/子任务 | 添加子任务按钮 | P0 |

### 页面详情：任务详情面板

- **页面目标**：提供高效直观的任务详情查看和编辑体验
- **核心功能**：双栏布局、富文本编辑、子任务管理、属性编辑
- **页面元素**：
  - 头部：任务名称 + 全屏/更多/关闭按钮
  - 左侧：标题输入 + 描述编辑器 + 子任务列表
  - 右侧：状态选择 + 基础属性 + 排期 + 工时 + 自定义字段 + 添加字段按钮

## 4. 依赖关系

| 依赖项 | 说明 | 当前状态 | 处理方案 |
|:-------|:-----|:--------:|:---------|
| 富文本编辑器 | 需集成第三方组件 | 待选型 | 建议：Quill / TipTap / Lexical |
| 字段配置模块 | 需扩展支持图标配置 | 已有基础 | 扩展 fieldConfig 数据结构 |
| 任务创建页 | 子任务创建调用 | 已有 | 直接复用 |

## 5. 约束条件

- **平台**：Web（桌面优先，响应式适配）
- **国际化**：必须支持 zh-CN, en-US, ja-JP, ko-KR
- **功能边界**：
  - 不实现：链接分享按钮、项目编号显示、子任务勾选完成
  - 富文本功能以集成组件实际能力为准
