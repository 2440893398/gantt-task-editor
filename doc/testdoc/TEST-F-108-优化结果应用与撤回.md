# TEST-F-108: AI 优化结果应用与撤回测试用例

## 测试范围
验证 AI 助手生成的优化建议（如任务润色、分解等）能否正确应用到甘特图任务中，以及应用后的撤回机制。同时验证按消息维度的重试和应用功能。

## 前置条件
1. AI 助手已配置有效 API Key
2. 甘特图中至少包含一个任务
3. 已打开 AI 助手抽屉

## 测试用例

| 用例ID | 用例名称 | 操作步骤 | 预期结果 | 优先级 |
|:---:|:---|:---|:---|:---:|
| TC-F108-01 | 单条消息应用修改 | 1. 选中一个任务<br>2. 请求 AI "润色当前任务"<br>3. 等待生成完成<br>4. 点击该条回复右下角的"应用"按钮 | 1. 提示"已应用修改"<br>2. 按钮变为绿色"已应用"状态且禁用<br>3. 甘特图对应任务名称/描述已更新 | P0 |
| TC-F108-02 | 单条消息重试生成 | 1. 对 AI 回复不满意<br>2. 点击该条回复右下角的"重试"按钮 | 1. AI 重新生成该条消息的回复<br>2. 历史记录更新为最新的回复内容 | P1 |
| TC-F108-03 | 多轮对话应用 | 1. 进行多轮对话，生成多个优化方案<br>2. 选择中间某一条回复点击"应用" | 1. 仅应用该条回复的内容<br>2. 其他回复的应用状态不受影响 | P1 |
| TC-F108-04 | 附加指令生效验证 | 1. 展开"附加指令"区域<br>2. 输入"请使用英文回复"<br>3. 发送消息 "Hello" | 1. AI 回复内容符合附加指令要求 (英文)<br>2. 系统提示词中包含附加指令上下文 | P1 |
| TC-F108-05 | 撤销修改 (手动) | 1. 应用修改后<br>2. 发现内容不合适<br>3. 使用甘特图的撤销功能 (Ctrl+Z) | 1. 任务内容恢复到应用修改之前的状态<br>2. (可选) AI 助手中的按钮状态重置 | P2 |

## 边界测试
1. **空内容应用**：如果 AI 回复内容为空或格式错误，点击应用应提示错误或无反应。
2. **任务已删除**：如果生成过程中任务被删除，点击应用应提示"任务不存在"。
3. **网络断开**：重试过程中断网，应显示错误提示并允许再次重试。

## 验证截图
*(在此处贴入测试执行时的截图)*
