# 测试用例文档（Test Case Document）

## 1. 测试概述
- **测试对象**：用户反馈优化需求（OPT-001 ~ OPT-004, BUG-001 ~ BUG-002）
- **需求来源**：doc/prd/PRD-用户反馈优化-需求清单.md
- **测试目标**：验证所有优化项和Bug修复符合验收标准
- **测试范围**：Gantt图表交互、本地存储、国际化、Excel导出

## 2. 测试环境
- **浏览器**：Chrome 120+, Firefox 120+, Safari 17+, Edge 120+
- **分辨率**：1920x1080 (桌面), 1366x768 (笔记本), 375x667 (移动端)
- **依赖条件**：
  - 本地开发服务器运行 (npm run dev)
  - 测试数据：至少包含10条任务数据
  - 语言包：zh-CN, en-US, ja-JP, ko-KR

---

## 3. 测试用例

### 3.1 OPT-001: 移除表格悬浮查看详情功能

> **注意**：仅移除**表格区域**的悬浮详情，**甘特图区域**的tooltip保留。

| 用例编号 | 用例名称 | 前置条件 | 测试步骤 | 预期结果 | 优先级 |
|:--------:|:--------|:--------|:--------|:--------|:------:|
| TC-001-01 | 表格-任务行悬浮无tooltip | 页面已加载，存在任务数据 | 1. 将鼠标移动到左侧**表格区域**的任务行上<br>2. 悬停2秒以上<br>3. 移动到不同任务行重复操作 | 表格区域无任何tooltip弹窗出现 | P0 |
| TC-001-02 | 表格-各列单元格悬浮无tooltip | 页面已加载，存在任务数据 | 1. 依次悬停在表格的各列单元格上（名称、日期、优先级、状态等）<br>2. 每个单元格悬停2秒 | 所有表格单元格均无tooltip弹窗 | P0 |
| TC-001-03 | 甘特图-甘特条悬浮有tooltip | 页面已加载，甘特图可见 | 1. 将鼠标移动到右侧**甘特图区域**的甘特条上<br>2. 悬停1-2秒 | 显示任务详情tooltip（包含任务名、日期、进度等信息） | P0 |
| TC-001-04 | 甘特图-里程碑悬浮有tooltip | 存在里程碑类型任务 | 1. 将鼠标悬停在甘特图中的里程碑标记上<br>2. 等待1-2秒 | 显示里程碑详情tooltip | P1 |
| TC-001-05 | 甘特图-依赖连线悬浮有tooltip | 存在任务依赖关系 | 1. 将鼠标悬停在甘特图中的依赖连线上<br>2. 等待1-2秒 | 显示依赖关系tooltip（如有） | P2 |

---

### 3.2 OPT-002: 支持直接在表格中编辑值

| 用例编号 | 用例名称 | 前置条件 | 测试步骤 | 预期结果 | 优先级 |
|:--------:|:--------|:--------|:--------|:--------|:------:|
| TC-002-01 | 编辑任务名称 | 存在任务数据 | 1. 双击任务名称单元格<br>2. 输入新名称"测试任务ABC"<br>3. 按Enter或点击其他区域 | 1. 单元格进入编辑模式<br>2. 新名称保存成功<br>3. 页面刷新后数据保留 | P0 |
| TC-002-02 | 编辑开始日期 | 存在任务数据 | 1. 双击开始日期单元格<br>2. 通过日期选择器选择新日期<br>3. 确认选择 | 1. 弹出日期选择器<br>2. 日期更新成功<br>3. 甘特条位置同步更新 | P0 |
| TC-002-03 | 编辑结束日期 | 存在任务数据 | 1. 双击结束日期单元格<br>2. 选择新的结束日期<br>3. 确认 | 1. 日期更新成功<br>2. 工期自动重新计算<br>3. 甘特条长度同步更新 | P0 |
| TC-002-04 | 编辑优先级下拉 | 存在任务数据 | 1. 双击优先级单元格<br>2. 从下拉列表选择新值<br>3. 确认选择 | 1. 显示本地化的下拉选项<br>2. 选择后立即保存<br>3. 显示更新后的值 | P0 |
| TC-002-05 | 编辑状态下拉 | 存在任务数据 | 1. 双击状态单元格<br>2. 从下拉列表选择新状态<br>3. 确认选择 | 1. 显示本地化的状态选项<br>2. 选择后立即保存<br>3. 任务样式可能随状态变化 | P0 |
| TC-002-06 | 编辑进度百分比 | 存在任务数据 | 1. 双击进度单元格<br>2. 输入新进度值"75"<br>3. 确认 | 1. 进度更新为75%<br>2. 甘特条进度指示同步更新 | P1 |
| TC-002-07 | 编辑自定义文本字段 | 存在自定义文本字段 | 1. 双击自定义文本字段单元格<br>2. 输入新文本<br>3. 确认 | 文本保存成功 | P1 |
| TC-002-08 | 编辑自定义数值字段 | 存在自定义数值字段 | 1. 双击自定义数值字段单元格<br>2. 输入数字"123.45"<br>3. 确认 | 数值保存成功，格式正确显示 | P1 |
| TC-002-09 | 编辑自定义单选字段 | 存在自定义单选字段 | 1. 双击自定义单选字段单元格<br>2. 从下拉选择选项<br>3. 确认 | 选项保存成功 | P1 |
| TC-002-10 | 编辑自定义多选字段 | 存在自定义多选字段 | 1. 双击自定义多选字段单元格<br>2. 勾选多个选项<br>3. 确认 | 多个选项保存成功，显示正确 | P1 |
| TC-002-11 | 取消编辑操作 | 正在编辑某单元格 | 1. 双击进入编辑模式<br>2. 修改内容<br>3. 按Esc键 | 修改被取消，恢复原值 | P1 |
| TC-002-12 | Tab键切换编辑 | 正在编辑某单元格 | 1. 编辑完成后按Tab键 | 焦点移动到下一个可编辑单元格 | P2 |

---

### 3.3 OPT-003: 本地缓存配置和数据

| 用例编号 | 用例名称 | 前置条件 | 测试步骤 | 预期结果 | 优先级 |
|:--------:|:--------|:--------|:--------|:--------|:------:|
| TC-003-01 | 自定义字段配置持久化 | 无缓存数据 | 1. 创建自定义字段（文本、数值、单选各一个）<br>2. 刷新页面<br>3. 检查自定义字段 | 自定义字段配置完整保留 | P0 |
| TC-003-02 | 列排序配置持久化 | 存在多列 | 1. 拖拽调整列顺序<br>2. 刷新页面<br>3. 检查列顺序 | 列排序配置保留，顺序一致 | P0 |
| TC-003-03 | 任务数据持久化-小数据量 | 无缓存数据 | 1. 创建10条任务<br>2. 刷新页面<br>3. 检查任务数据 | 所有任务数据完整保留 | P0 |
| TC-003-04 | 任务数据持久化-大数据量 | 无缓存数据 | 1. 导入1000条任务数据<br>2. 刷新页面<br>3. 检查任务数据 | 所有任务数据完整保留，加载性能正常 | P0 |
| TC-003-05 | 任务数据持久化-超大数据量 | 无缓存数据 | 1. 导入10000条任务数据<br>2. 刷新页面<br>3. 检查任务数据 | 任务数据完整保留（使用IndexedDB） | P1 |
| TC-003-06 | 依赖关系持久化 | 存在任务依赖 | 1. 创建任务间依赖关系<br>2. 刷新页面<br>3. 检查依赖关系 | 依赖关系完整保留，连线正确显示 | P0 |
| TC-003-07 | 语言设置持久化 | 默认语言 | 1. 切换到日语<br>2. 刷新页面<br>3. 检查语言设置 | 语言设置保留为日语 | P1 |
| TC-003-08 | 清除缓存功能 | 存在缓存数据 | 1. 找到清除缓存选项<br>2. 执行清除操作<br>3. 确认清除<br>4. 刷新页面 | 1. 显示确认提示<br>2. 所有本地数据被清除<br>3. 页面恢复初始状态 | P0 |
| TC-003-09 | 隐私模式降级处理 | 浏览器隐私模式 | 1. 在隐私/无痕模式打开应用<br>2. 创建任务数据<br>3. 观察系统行为 | 1. 显示友好提示说明存储受限<br>2. 基本功能仍可使用<br>3. 不出现JS错误 | P1 |
| TC-003-10 | 存储容量监控 | 大量缓存数据 | 1. 持续添加大量数据<br>2. 观察系统提示 | 接近容量限制时显示警告提示 | P2 |
| TC-003-11 | 列宽度持久化 | 存在多列 | 1. 调整某列宽度<br>2. 刷新页面<br>3. 检查列宽度 | 列宽度设置保留 | P1 |
| TC-003-12 | 数据导入覆盖确认 | 存在缓存数据 | 1. 有本地缓存数据<br>2. 导入新的JSON/Excel文件<br>3. 观察系统行为 | 提示用户数据将被覆盖，需确认 | P1 |

---

### 3.4 OPT-004: 优化导入导出图标

| 用例编号 | 用例名称 | 前置条件 | 测试步骤 | 预期结果 | 优先级 |
|:--------:|:--------|:--------|:--------|:--------|:------:|
| TC-004-01 | Excel导入图标可识别 | 工具栏可见 | 1. 查看Excel导入按钮<br>2. 观察图标样式 | 图标包含向下箭头+Excel特征，易于识别为"导入" | P1 |
| TC-004-02 | Excel导出图标可识别 | 工具栏可见 | 1. 查看Excel导出按钮<br>2. 观察图标样式 | 图标包含向上箭头+Excel特征，易于识别为"导出" | P1 |
| TC-004-03 | JSON导入图标可识别 | 工具栏可见 | 1. 查看JSON导入按钮<br>2. 观察图标样式 | 图标包含向下箭头+代码/JSON特征 | P1 |
| TC-004-04 | JSON导出图标可识别 | 工具栏可见 | 1. 查看JSON导出按钮<br>2. 观察图标样式 | 图标包含向上箭头+代码/JSON特征 | P1 |
| TC-004-05 | 图标风格统一 | 工具栏可见 | 1. 对比所有导入导出图标<br>2. 检查视觉一致性 | 图标尺寸、线条粗细、颜色风格统一 | P2 |
| TC-004-06 | 图标悬停提示 | 工具栏可见 | 1. 鼠标悬停在各导入导出按钮上 | 显示清晰的功能提示文字 | P2 |

---

### 3.5 BUG-001: 优先级/状态下拉值未本地化

| 用例编号 | 用例名称 | 前置条件 | 测试步骤 | 预期结果 | 优先级 |
|:--------:|:--------|:--------|:--------|:--------|:------:|
| TC-B01-01 | 中文-优先级下拉本地化 | 语言设置为zh-CN | 1. 打开任务编辑（弹窗或内联）<br>2. 点击优先级下拉 | 显示：高、中、低 | P0 |
| TC-B01-02 | 中文-状态下拉本地化 | 语言设置为zh-CN | 1. 打开任务编辑<br>2. 点击状态下拉 | 显示：未开始、进行中、已完成、已延期 | P0 |
| TC-B01-03 | 英文-优先级下拉本地化 | 语言设置为en-US | 1. 切换到英文<br>2. 点击优先级下拉 | 显示：High、Medium、Low | P0 |
| TC-B01-04 | 英文-状态下拉本地化 | 语言设置为en-US | 1. 切换到英文<br>2. 点击状态下拉 | 显示：Not Started、In Progress、Completed、Delayed | P0 |
| TC-B01-05 | 日语-优先级下拉本地化 | 语言设置为ja-JP | 1. 切换到日语<br>2. 点击优先级下拉 | 显示：高、中、低（日语） | P0 |
| TC-B01-06 | 日语-状态下拉本地化 | 语言设置为ja-JP | 1. 切换到日语<br>2. 点击状态下拉 | 显示对应日语状态文案 | P0 |
| TC-B01-07 | 韩语-优先级下拉本地化 | 语言设置为ko-KR | 1. 切换到韩语<br>2. 点击优先级下拉 | 显示：높음、중간、낮음 | P0 |
| TC-B01-08 | 韩语-状态下拉本地化 | 语言设置为ko-KR | 1. 切换到韩语<br>2. 点击状态下拉 | 显示对应韩语状态文案 | P0 |
| TC-B01-09 | 实时语言切换-下拉更新 | 编辑弹窗已打开 | 1. 打开任务编辑弹窗<br>2. 不关闭弹窗，切换语言<br>3. 查看下拉选项 | 下拉选项实时更新为新语言 | P1 |
| TC-B01-10 | 表格显示值本地化 | 存在任务数据 | 1. 设置任务优先级为"高"<br>2. 切换到英文<br>3. 查看表格显示 | 表格中显示"High"而非"高" | P0 |

---

### 3.6 BUG-002: Excel导出模板缺少下拉选项

| 用例编号 | 用例名称 | 前置条件 | 测试步骤 | 预期结果 | 优先级 |
|:--------:|:--------|:--------|:--------|:--------|:------:|
| TC-B02-01 | 优先级列有下拉选项 | - | 1. 导出Excel模板<br>2. 用Excel打开<br>3. 点击优先级列单元格 | 显示下拉箭头，可选择高/中/低 | P0 |
| TC-B02-02 | 状态列有下拉选项 | - | 1. 导出Excel模板<br>2. 用Excel打开<br>3. 点击状态列单元格 | 显示下拉箭头，可选择各状态值 | P0 |
| TC-B02-03 | 单选自定义字段有下拉 | 存在单选类型自定义字段 | 1. 导出Excel模板<br>2. 查看对应自定义字段列 | 该列有下拉选项，选项值正确 | P0 |
| TC-B02-04 | 多选自定义字段有提示 | 存在多选类型自定义字段 | 1. 导出Excel模板<br>2. 查看对应自定义字段列 | 列头有说明可用值，或有数据验证 | P1 |
| TC-B02-05 | 数值列格式限制 | 存在数值类型字段 | 1. 导出Excel模板<br>2. 在数值列输入文本"abc"<br>3. 尝试保存或离开单元格 | 显示错误提示，拒绝非数字输入 | P0 |
| TC-B02-06 | 日期列格式限制 | - | 1. 导出Excel模板<br>2. 在日期列输入非日期值<br>3. 尝试保存 | 显示格式错误提示 | P1 |
| TC-B02-07 | 下拉选项本地化-中文 | 语言设置为zh-CN | 1. 导出Excel模板<br>2. 查看下拉选项 | 下拉选项显示中文 | P0 |
| TC-B02-08 | 下拉选项本地化-英文 | 语言设置为en-US | 1. 切换到英文<br>2. 导出Excel模板<br>3. 查看下拉选项 | 下拉选项显示英文 | P0 |
| TC-B02-09 | 下拉选项本地化-日语 | 语言设置为ja-JP | 1. 切换到日语<br>2. 导出Excel模板<br>3. 查看下拉选项 | 下拉选项显示日语 | P1 |
| TC-B02-10 | 下拉选项本地化-韩语 | 语言设置为ko-KR | 1. 切换到韩语<br>2. 导出Excel模板<br>3. 查看下拉选项 | 下拉选项显示韩语 | P1 |
| TC-B02-11 | 导入已填写模板 | 已填写完整的Excel模板 | 1. 用导出的模板填写数据<br>2. 导入回系统<br>3. 检查数据 | 数据正确导入，下拉值正确识别 | P0 |

---

### 3.7 边界测试

| 用例编号 | 用例名称 | 前置条件 | 测试步骤 | 预期结果 | 优先级 |
|:--------:|:--------|:--------|:--------|:--------|:------:|
| TC-BD-01 | 任务名称最大长度 | 内联编辑可用 | 1. 编辑任务名称<br>2. 输入500字符<br>3. 保存 | 名称被截断或显示错误提示 | P1 |
| TC-BD-02 | 任务名称为空 | 内联编辑可用 | 1. 编辑任务名称<br>2. 清空内容<br>3. 尝试保存 | 显示错误提示，不允许空名称 | P0 |
| TC-BD-03 | 进度值边界-0% | 内联编辑可用 | 1. 编辑进度<br>2. 输入0<br>3. 保存 | 保存成功，显示0% | P1 |
| TC-BD-04 | 进度值边界-100% | 内联编辑可用 | 1. 编辑进度<br>2. 输入100<br>3. 保存 | 保存成功，显示100% | P1 |
| TC-BD-05 | 进度值超出范围 | 内联编辑可用 | 1. 编辑进度<br>2. 输入150<br>3. 尝试保存 | 显示错误提示或自动修正为100 | P1 |
| TC-BD-06 | 进度值负数 | 内联编辑可用 | 1. 编辑进度<br>2. 输入-10<br>3. 尝试保存 | 显示错误提示或自动修正为0 | P1 |
| TC-BD-07 | 结束日期早于开始日期 | 内联编辑可用 | 1. 设置开始日期为2026-01-20<br>2. 设置结束日期为2026-01-15<br>3. 保存 | 显示错误提示，不允许保存 | P0 |
| TC-BD-08 | 自定义数值字段-负数 | 存在数值类型自定义字段 | 1. 编辑数值字段<br>2. 输入-100<br>3. 保存 | 根据字段配置接受或拒绝 | P2 |
| TC-BD-09 | 自定义数值字段-小数 | 存在数值类型自定义字段 | 1. 编辑数值字段<br>2. 输入123.456<br>3. 保存 | 保存成功，精度处理正确 | P2 |
| TC-BD-10 | localStorage接近满载 | localStorage已有大量数据 | 1. 模拟localStorage接近5MB<br>2. 尝试保存新配置 | 系统检测到并提示用户 | P1 |

---

### 3.8 异常测试

| 用例编号 | 用例名称 | 前置条件 | 测试步骤 | 预期结果 | 优先级 |
|:--------:|:--------|:--------|:--------|:--------|:------:|
| TC-EX-01 | IndexedDB不可用 | 禁用IndexedDB | 1. 禁用浏览器IndexedDB<br>2. 打开应用<br>3. 操作任务数据 | 显示友好提示，降级使用localStorage | P1 |
| TC-EX-02 | localStorage不可用 | 禁用localStorage | 1. 禁用浏览器localStorage<br>2. 打开应用 | 显示存储不可用提示，基本功能可用 | P1 |
| TC-EX-03 | 缓存数据损坏 | 存在缓存数据 | 1. 手动修改localStorage数据为无效JSON<br>2. 刷新页面 | 检测到损坏，提示用户并清除 | P1 |
| TC-EX-04 | 网络断开时操作 | 应用已加载 | 1. 断开网络<br>2. 执行各种操作<br>3. 恢复网络 | 本地操作不受影响（纯前端应用） | P2 |
| TC-EX-05 | 并发编辑同一单元格 | 多标签页打开 | 1. 在两个标签页打开同一应用<br>2. 同时编辑同一任务<br>3. 分别保存 | 后保存的覆盖先保存的，无JS错误 | P2 |
| TC-EX-06 | Excel模板格式错误导入 | 有错误格式Excel | 1. 准备格式错误的Excel文件<br>2. 尝试导入 | 显示友好错误提示，说明问题位置 | P1 |
| TC-EX-07 | JSON格式错误导入 | 有错误格式JSON | 1. 准备格式错误的JSON文件<br>2. 尝试导入 | 显示友好错误提示 | P1 |
| TC-EX-08 | 特殊字符输入 | 内联编辑可用 | 1. 在任务名称中输入特殊字符<br>2. 包括: <script>alert(1)</script><br>3. 保存并查看 | XSS被正确转义，字符正常显示 | P0 |

---

### 3.9 国际化测试

| 用例编号 | 用例名称 | 前置条件 | 测试步骤 | 预期结果 | 优先级 |
|:--------:|:--------|:--------|:--------|:--------|:------:|
| TC-I18N-01 | 中文界面完整性 | 语言设置为zh-CN | 1. 遍历所有功能界面<br>2. 检查所有文案 | 所有文案显示中文，无英文残留 | P0 |
| TC-I18N-02 | 英文界面完整性 | 语言设置为en-US | 1. 遍历所有功能界面<br>2. 检查所有文案 | 所有文案显示英文 | P0 |
| TC-I18N-03 | 日语界面完整性 | 语言设置为ja-JP | 1. 遍历所有功能界面<br>2. 检查所有文案 | 所有文案显示日语，无错乱 | P1 |
| TC-I18N-04 | 韩语界面完整性 | 语言设置为ko-KR | 1. 遍历所有功能界面<br>2. 检查所有文案 | 所有文案显示韩语，无错乱 | P1 |
| TC-I18N-05 | 日期格式本地化 | 不同语言设置 | 1. 分别切换4种语言<br>2. 查看日期显示格式 | 日期格式符合各地区习惯 | P1 |
| TC-I18N-06 | 长文本布局适应 | 语言设置为de-DE（如支持） | 1. 查看按钮、标签等UI元素<br>2. 检查文字是否截断 | 无文字截断或布局错乱 | P2 |
| TC-I18N-07 | 语言切换后编辑器更新 | 编辑弹窗打开 | 1. 打开任务编辑弹窗<br>2. 切换语言<br>3. 检查弹窗内容 | 弹窗内所有文案实时更新 | P1 |
| TC-I18N-08 | Toast提示本地化 | 不同语言设置 | 1. 执行会触发Toast的操作<br>2. 检查Toast文案 | Toast文案显示当前语言 | P1 |

---

## 4. 测试数据

### 正常数据
- **任务名称**：项目启动会议、需求分析、系统设计、开发阶段1
- **日期范围**：2026-01-01 ~ 2026-12-31
- **优先级**：高、中、低
- **状态**：未开始、进行中、已完成、已延期
- **进度值**：0, 25, 50, 75, 100

### 边界数据
- **任务名称长度**：1字符、255字符、500字符
- **进度值**：0、100、-1、101
- **日期边界**：同一天开始结束、跨年任务
- **数据量**：0条、1条、100条、1000条、10000条

### 异常数据
- **无效JSON**：`{invalid json}`
- **XSS测试字符串**：`<script>alert('xss')</script>`
- **SQL注入测试**：`'; DROP TABLE tasks; --`
- **超长字符串**：10000字符
- **特殊字符**：`< > & " ' / \ \n \t`

---

## 5. 自动化测试覆盖计划

| 需求ID | 自动化覆盖 | 测试工具 | 说明 |
|:------:|:----------:|:--------:|:-----|
| OPT-001 | ✅ 完全覆盖 | Playwright | DOM检查tooltip元素 |
| OPT-002 | ✅ 完全覆盖 | Playwright | 模拟双击编辑操作 |
| OPT-003 | ⚠️ 部分覆盖 | Playwright + Vitest | IndexedDB需真实浏览器 |
| OPT-004 | ⚠️ 部分覆盖 | 人工验证 | 图标视觉效果需人工确认 |
| BUG-001 | ✅ 完全覆盖 | Playwright | 语言切换+下拉检查 |
| BUG-002 | ⚠️ 部分覆盖 | 人工+脚本 | Excel文件需手动验证 |

---

## 6. 测试执行优先级

### 第一轮：P0关键用例（必须通过）
- TC-B01-01 ~ TC-B01-10（下拉本地化）
- TC-003-01 ~ TC-003-08（数据持久化）
- TC-002-01 ~ TC-002-05（核心编辑功能）
- TC-B02-01 ~ TC-B02-05（Excel下拉验证）

### 第二轮：P1重要用例
- TC-001-01 ~ TC-001-03（tooltip移除）
- TC-002-06 ~ TC-002-12（扩展编辑功能）
- TC-BD-01 ~ TC-BD-10（边界测试）

### 第三轮：P2体验用例
- TC-004-01 ~ TC-004-06（图标优化）
- TC-EX-01 ~ TC-EX-08（异常处理）
